# setup-env CLI Tool

This command-line tool is used to generate a `.env` file for automated environments such as CI pipelines, Playwright testing setups, and deployment workflows.

It reads from a template file named `env.test`, replaces placeholder variables with actual system environment values, and writes the result to a `.env` file inside the same application directory.

---

## Overview

This program performs the following steps:

1. Accepts a directory path from the command line
2. Looks for a file named `env.test` inside that directory
3. Replaces variables in the format `{{VARIABLE_NAME}}` with values from the system environment
4. Writes the processed output to a `.env` file in that same directory

The source code logic:

```go
if len(os.Args) < 2 {
    fmt.Println("Usage: setup-env <app-directory>")
    os.Exit(1)
}

appDir := os.Args[1]
templatePath := filepath.Join(appDir, "env.test")
outputPath := filepath.Join(appDir, ".env")
```

This means the tool expects a directory as input, not a file.

---

## Required File Conventions

The target directory must contain:

Input file:

```
env.test
```

Output file (generated automatically):

```
.env
```

---

## Example Directory Structure

```
my-app/
├── env.test
└── .env          (generated by the tool)
```

---

## Example env.test Format

```env
API_URL={{API_URL}}
DB_PASSWORD={{DB_PASSWORD}}
```

System environment variables must be set before running the command:

```bash
export API_URL=https://api.example.com
export DB_PASSWORD=supersecret
```

---

## How to Run

### 1. Using as a global CLI

```bash
setup-env my-app
```

### 2. Using as a local binary

If the binary is stored inside the project:

```bash
./setup-env my-app
```

---

## Output Example

Generated `.env` file:

```env
API_URL=https://api.example.com
DB_PASSWORD=supersecret
```

---

## Argument Rules

| Rule          | Description                            |
| ------------- | -------------------------------------- |
| Argument      | Must be a valid directory path         |
| Template file | Must be named `env.test`               |
| Output file   | Always `.env`                          |
| Location      | Generated in the same directory passed |

---

## Common Errors

### Could not read env.test

Occurs when:

- The file does not exist
- The path is incorrect
- Insufficient permissions

Ensure the following:

```bash
ls <app-directory>/env.test
```

---

## Internal Behavior

The tool uses this call to process variables:

```go
result := envutils.ReplaceTemplateVars(string(content))
```

This function replaces all occurrences of:

```
{{VARIABLE_NAME}}
```

with the corresponding value from `process.env`.

If a variable is not found, it will be replaced with an empty string.

---

## Typical Use Cases

- Playwright CI pipelines
- Docker build stages
- Automated test environments
- Deployment scripts

---

## Installation From Release

Download the correct binary from the GitHub Releases section and make it executable if required:

Linux / macOS:

```bash
chmod +x setup-env
./setup-env my-app
```

Windows:

```powershell
setup-env.exe my-app
```

---

## Summary

1. Create an `env.test` file with placeholders
2. Set required environment variables
3. Run:

   ```bash
   setup-env <directory>
   ```

4. A `.env` file will be created with resolved values

---

Maintained as part of the go-utils toolkit.
